(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{f0d9:function(a,e,t){"use strict";t.r(e);var o=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("q-table",{attrs:{title:"Mensajes sin leer",data:a.mensajes,columns:a.columnas,"row-key":"caso","rows-per-page-options":[10,20,30,0],loading:a.loading},scopedSlots:a._u([{key:"body",fn:function(e){return[t("q-tr",{attrs:{props:e}},[t("q-td",{key:"Caratula",attrs:{props:e}},[a._v("\n        "+a._s(e.row.Caratula)+"\n      ")]),t("q-td",{key:"Contenido",attrs:{props:e}},[a._v("\n        "+a._s(e.row.Contenido)+"\n      ")]),t("q-td",{key:"Acciones",attrs:{props:e}},[t("q-icon",{staticStyle:{cursor:"pointer"},attrs:{name:"clear",size:"xs",color:"red"},on:{click:function(t){return a.marcarLeido(e.row.IdChat,e.row.IdMensaje,e.row.IdMediador?e.row.IdMediador:null,e.row.IdContacto?e.row.IdContacto:null)}}},[t("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[t("span",{staticClass:"text-body2"},[a._v("Marcar como leido")])])],1),t("q-icon",{staticStyle:{cursor:"pointer","margin-left":"30px"},attrs:{name:"chat",size:"xs",color:"primary"},on:{click:function(t){return a.abrirChat(e.row)}}},[t("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[t("span",{staticClass:"text-body2"},[a._v("Ir al chat")])])],1)],1)],1)]}}])})},n=[],r=(t("20d6"),t("8daa")),s=t("2a19"),i={data:function(){return{loading:!1,columnas:[{name:"Caratula",required:!0,label:"Caso",align:"left",sortable:!0},{name:"Contenido",required:!0,label:"Ultimo Mensaje",align:"left",sortable:!0},{name:"Acciones",required:!0,label:"Acciones",align:"left",sortable:!0}],mensajes:[]}},created:function(){sessionStorage.getItem("mensajes")&&(this.mensajes=JSON.parse(sessionStorage.getItem("mensajes")),sessionStorage.removeItem("mensajes"),this.mensajes[0].IdMediador&&(this.columnas[0].label="Mediador"),this.mensajes[0].IdContacto&&(this.columnas[0].label="Contacto"))},methods:{marcarLeido:function(a,e,t,o){var n=this;this.loading=!0,r["a"].Post("/chats/".concat(a,"/actualizar"),{IdUltimoLeido:e,mediador:t,contacto:o},(function(e){if(e.Error)s["a"].create(e.Error);else{var t=n.mensajes.findIndex((function(e){return e.IdChat===a}));n.mensajes.splice(t,1),n.$nextTick((function(){n.loading=!1})),s["a"].create("Ultimo mensaje leido actualizado")}}))},abrirChat:function(a){var e=this.$router.resolve({name:"Chat",query:{id:a.IdChat,idCaso:a.IdCaso,telefono:a.Telefono,caratula:a.Caratula,idContacto:a.IdContacto,idMediacion:a.IdMediador}});window.open(e.href,"_blank"),this.marcarLeido(a.IdChat,a.IdMensaje,a.IdMediador?a.IdMediador:null,a.IdContacto?a.IdContacto:null)}}},d=i,l=t("2877"),c=Object(l["a"])(d,o,n,!1,null,null,null);e["default"]=c.exports}}]);