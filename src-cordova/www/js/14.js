(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{"0e66":function(a,t,s){"use strict";s.r(t);var o=function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("q-page",[a.seccion?s("div",{staticClass:"map-header q-pl-md q-pr-md flex items-center justify-between"},[s("q-btn",{staticClass:"logo-menu",attrs:{flat:"",dense:"",round:"",type:"a",href:"Maps","aria-label":"Inicio"}},[s("img",{attrs:{src:"statics/img/logo.png",width:"30",height:"25"}})]),s("span",{staticClass:"text-white text-bold text-h6"},[a._v("DocDoc! Maps")])],1):a._e(),"inicio"===a.seccion?s("div",{staticClass:"position-relative"},[s("div",{staticClass:"welcome-container"},[s("span",{staticClass:"text1"},[a._v("Bienvenido a")]),s("span",{staticClass:"text2"},[a._v("Doc Doc Maps®")])]),s("div",{staticClass:"buttons-container column items-center"},[a.loading?s("q-spinner",{staticClass:"q-mb-lg",attrs:{color:"teal",size:"sm"}}):s("q-btn",{staticClass:"glossy q-mb-lg visitas",attrs:{size:"lg",rounded:"",color:"positive",label:"Visitas"},on:{click:function(t){a.loading=!0,a.buscarCasos(1,"visitas","N",1e4)}}}),s("q-btn",{staticClass:"glossy buscar",attrs:{size:"lg",rounded:"",color:"negative",label:"Buscar Casos"},on:{click:function(t){a.seccion="casos",a.buscarCasos()}}})],1)]):a._e(),"visitas"===a.seccion?s("div",{staticClass:"position-relative"},[s("div",{attrs:{id:"mapCad"}})]):a._e(),"casos"===a.seccion?s("div",{staticClass:"q-pr-lg q-pl-lg full-height"},[s("q-input",{staticClass:"busqueda-input q-mb-lg shadow-3",attrs:{outlined:"",rounded:"","label-color":"grey-2",color:"grey-4",debounce:300,placeholder:"Buscar"},on:{change:function(t){a.loading=!0,a.buscarCasos()}},scopedSlots:a._u([{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!1,2901929698),model:{value:a.busqueda,callback:function(t){a.busqueda=t},expression:"busqueda"}}),a.loading?s("div",[s("Loading")],1):s("div",[s("div",{staticClass:"q-pa-lg flex flex-center"},[s("q-pagination",{attrs:{max:a.maxpags,input:""},on:{input:a.buscarCasos},model:{value:a.pag,callback:function(t){a.pag=t},expression:"pag"}})],1),a._l(a.casos,(function(t,o){return s("q-card",{key:t.IdCasoPendiente,staticClass:"full-width text-white q-ma-sm q-pa-sm",staticStyle:{background:"radial-gradient(circle, #35a2ff 0%, #014a88 100%)"}},[s("div",{staticClass:"full-width flex justify-start q-pa-xs"},[a._v("\n          Nombre: "+a._s(t.Apellidos)+", "+a._s(t.Nombres)+"\n        ")]),s("div",{staticClass:"full-width flex justify-start q-pa-xs"},[a._v("\n          Domicilio: "+a._s(t.Domicilio)+"\n        ")]),s("div",{staticClass:"full-width flex justify-start q-pa-xs"},[a._v("\n          Telefono: "+a._s(t.Telefono||"---")+"\n        ")]),t.Latitud?s("q-icon",{staticClass:"cursor-pointer",staticStyle:{color:"#49C00F"},attrs:{name:"where_to_vote",size:"lg"},on:{click:function(s){return a.abrirMapa(t,o)}}},[s("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle",offset:[10,0]}},[a._v("Ver en el mapa")])],1):s("q-icon",{staticClass:"cursor-pointer",staticStyle:{color:"#B1000E"},attrs:{name:"location_off",size:"lg"},on:{click:function(s){return a.abrirMapa(t,o)}}},[s("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle",offset:[10,0]}},[a._v("Geolocalizar")])],1)],1)})),s("div",{staticClass:"q-pa-lg flex flex-center"},[s("q-pagination",{attrs:{max:a.maxpags,input:""},on:{input:a.buscarCasos},model:{value:a.pag,callback:function(t){a.pag=t},expression:"pag"}})],1)],2)],1):a._e(),s("q-dialog",{model:{value:a.modalEditar,callback:function(t){a.modalEditar=t},expression:"modalEditar"}},[s("q-card",[s("div",{staticClass:"row justify-between text-center q-pa-lg relative-position"},[s("span",{staticClass:"col-6 text-weight-bold text-subtitle1"},[a._v(a._s(a.casoAux.Apellidos+", "+a.casoAux.Nombres))]),s("span",{staticClass:"col-6 text-weight-bold text-subtitle1"},[a._v(a._s(a.casoAux.Documento))]),s("q-input",{staticClass:"col-12",attrs:{label:"Domicilio",type:"text"},model:{value:a.casoAux.Domicilio,callback:function(t){a.$set(a.casoAux,"Domicilio",t)},expression:"casoAux.Domicilio"}}),s("div",{staticClass:"col-6 q-pr-sm"},[s("q-input",{staticClass:"casillas",attrs:{label:"Telefono",type:"number"},model:{value:a.casoAux.Telefono,callback:function(t){a.$set(a.casoAux,"Telefono",t)},expression:"casoAux.Telefono"}})],1),s("div",{staticClass:"col-6 q-pl-sm"},[s("q-select",{staticClass:"casillas",attrs:{options:a.opcionesEstados,label:"Estado","emit-value":"","map-options":""},model:{value:a.casoAux.IdEstadoCasoPendiente,callback:function(t){a.$set(a.casoAux,"IdEstadoCasoPendiente",t)},expression:"casoAux.IdEstadoCasoPendiente"}})],1),s("div",{staticClass:"col-12 flex justify-start items-center"},[s("q-checkbox",{attrs:{"true-value":1,"false-value":0,label:"Marcar como Visitado"},model:{value:a.casoAux.Visitado,callback:function(t){a.$set(a.casoAux,"Visitado",t)},expression:"casoAux.Visitado"}})],1),s("div",{staticClass:"q-mt-md col-12 flex justify-center"},[s("q-btn",{staticClass:"q-mr-xs",attrs:{push:"","no-caps":"",label:"Confirmar",color:"positive"},on:{click:function(t){return a.editarCaso(a.casoAux)}}}),s("q-btn",{staticClass:"q-ml-xs",attrs:{push:"","no-caps":"",label:"Cancelar",color:"negative"},on:{click:function(t){a.modalEditar=!1}}})],1)],1)])],1),s("q-dialog",{model:{value:a.modalMap,callback:function(t){a.modalMap=t},expression:"modalMap"}},[s("q-card",{staticClass:"full-width full-height",staticStyle:{"max-width":"800px"}},[s("MapaGeo",{attrs:{Caso:a.casoAux},on:{cerrar:function(t){a.modalMap=!1},confirmado:a.guardarGeo}})],1)],1)],1)},e=[],i=(s("8e6e"),s("8a81"),s("ac6a"),s("cadf"),s("06db"),s("456d"),s("28a5"),s("20d6"),s("9523")),n=s.n(i),c=s("b628"),l=s("8daa"),r=s("2a19"),d=s("0d59"),u=s("3b16"),p=s("4272"),m=s("3a5e"),f=s("181b");function b(a,t){var s=Object.keys(a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),s.push.apply(s,o)}return s}function g(a){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?b(Object(s),!0).forEach((function(t){n()(a,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):b(Object(s)).forEach((function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(s,t))}))}return a}var v={components:{MapaGeo:f["a"],Loading:m["a"],QSpinner:d["a"],QPagination:u["a"]},data:function(){return{seccion:this.$route.query.sec||"inicio",loading:!1,modalEditar:!1,modalMap:!1,busqueda:"",casos:[],pag:1,maxpags:1,loaderMap:null,map:null,opcionesEstados:[],opPrioridad:{1:{icon:"red-circle.png",class:"prioridad_alta",prioridad:"ALTA"},2:{icon:"ylw-circle.png",class:"prioridad_media",prioridad:"MEDIA"},3:{icon:"blu-circle.png",class:"prioridad_baja",prioridad:"BAJA"}},casoAux:{}}},created:function(){var a=this;c["a"].isLoggedIn||(this.seccion=null,this.$router.push({path:"/Login"})),l["a"].Get("/casos-pendientes/estados",{},(function(t){t.Error?a.$q.notify(t.Error):a.opcionesEstados=t.map((function(a){return{label:a.EstadoCasoPendiente,value:parseInt(a.IdEstadoCasoPendiente)}}))}))},mounted:function(){"visitas"===this.seccion&&this.buscarCasos(1,"visitas","N",1e4)},methods:{guardarGeo:function(a,t){var s=this.casoAux.i;this.casos[s].Domicilio=t,this.casos[s]=g(g({},this.casos[s]),a),this.casoAux.Domicilio=t,this.casoAux=g(g({},this.casoAux),a),this.modalMap=!1,this.editarCaso(this.casoAux)},abrirMapa:function(a,t){a.i=t,this.casoAux=a,this.modalMap=!0},buscarCasos:function(){var a=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"casos",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30,i=30*(t-1);this.pag=t,this.casos=[],l["a"].Get("/casos-pendientes",{Cadena:this.busqueda,Documento:"",Offset:i,Limit:e,Visitado:o},(function(t){if(t.Error)a.$q.notify(t.Error);else{t.forEach((function(a){t.Visitado=0,t.IdEstadoCasoPendiente=parseInt(t.IdEstadoCasoPendiente)})),a.casos=t;var o=t.length?t[0].Cant:0;a.maxpags=Math.ceil(parseInt(o)/30),a.loading=!1,a.seccion=s,"visitas"===s&&a.$nextTick((function(){a.generarMapa()}))}}))},editarCaso:function(a){var t=this,s={IdCasoPendiente:a.IdCasoPendiente,Nombres:a.Nombres,Apellidos:a.Apellidos,Domicilio:a.Domicilio,Documento:a.Documento,Telefono:a.Telefono,Prioridad:a.Prioridad,IdEstadoCasoPendiente:a.IdEstadoCasoPendiente,IdOrigen:a.IdOrigen,Visitado:a.Visitado,Latitud:a.Latitud,Longitud:a.Longitud,Lesion:a.Lesion};this.modalEditar=!1,l["a"].Post("/casos-pendientes/editar",{caso:JSON.stringify(s)},(function(s){if(s.Error)r["a"].create(s.Error);else{var o=t.casos.findIndex((function(t){return t.IdCasoPendiente===a.IdCasoPendiente}));t.casos[o]=a,t.casoAux={},r["a"].create("Los datos se actualizaron correctamente"),1===a.Visitado&&a.marker.setMap(null)}}))},generarMapa:function(){var a=this;this.loaderMap=new p["a"]({apiKey:"AIzaSyDw8NFG-Llw1Kytr1SqaJ0aT7G4lRlP38Y",version:"weekly"}),this.loaderMap.load().then((function(){a.map=new google.maps.Map(document.getElementById("mapCad"),{zoom:13,center:{lat:-26.82414,lng:-65.2226}}),a.casos.forEach((function(t,s){t.Latitud&&a.addMarker(t,s)}))}))},addMarker:function(a,t){var s=this,o="http://maps.google.com/mapfiles/kml/paddle/";a.marker=new google.maps.Marker({position:{lat:parseFloat(a.Latitud),lng:parseFloat(a.Longitud)},map:this.map,icon:o+this.opPrioridad[parseInt(a.Prioridad)].icon}),a.infoWindow=new google.maps.InfoWindow({content:'<div class="ventana">\n                    <table class="tabla-ventana">  \n                      <th colspan="2"><span class="titulo-tabla">'.concat(a.Domicilio.split(",").slice(0,-2).join(",").toUpperCase(),'<br></span></th>\n                      <tr><td><b>Nombre:</b></td><td class="celda-value">').concat(a.Apellidos,", ").concat(a.Nombres,'</td></tr>\n                      <tr><td><b>Teléfono:</b></td><td class="celda-value">').concat(a.Telefono||" --- ",'</td></tr>\n                      <tr><td><b>Prioridad:</b></td><td class="celda-value ').concat(this.opPrioridad[parseInt(a.Prioridad)].class,'">').concat(this.opPrioridad[parseInt(a.Prioridad)].prioridad,'</td></tr>\n                    </table>\n                    <div class="row row-center">\n                      <button id="editar-').concat(a.IdCasoPendiente,'" class="btn btn-blue btn-ventana cursor-pointer q-mr-lg" type="button">Editar datos</button>\n                      <button id="visitado-').concat(a.IdCasoPendiente,'" class="btn btn-green btn-ventana cursor-pointer" type="button"><b>Visitado</b></button>\n                    </div>\n                  </div>')}),a.marker.addListener("click",(function(){a.infoWindow.open(s.map,a.marker),s.$nextTick((function(){a.botonEditar=document.getElementById("editar-".concat(a.IdCasoPendiente)),a.botonVisitado=document.getElementById("visitado-".concat(a.IdCasoPendiente)),a.botonEditar.addEventListener("click",(function(){s.modalEditar=!0,s.casoAux=s.casos[t],s.casoAux.Visitado=0,s.casoAux.IdEstadoCasoPendiente=parseInt(s.casoAux.IdEstadoCasoPendiente)})),a.botonVisitado.addEventListener("click",(function(){s.casos[t].Visitado=1,s.editarCaso(s.casos[t])}))}))})),this.casos[t]=a}}},h=v,x=(s("49fb"),s("2877")),C=Object(x["a"])(h,o,e,!1,null,null,null);t["default"]=C.exports},"49fb":function(a,t,s){"use strict";var o=s("7dcd"),e=s.n(o);e.a},"7dcd":function(a,t,s){}}]);